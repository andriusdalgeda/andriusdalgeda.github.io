<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>    <!-- Metadata, OpenGraph and Schema.org -->

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Andrius Dalgeda | Project 1</title>
    <meta name="description" content="Anything involving images" />
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website" />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    
  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://andriusdalgeda.github.io/"><span class="font-weight-bold">Andrius</span>   Dalgeda</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">Home</a>
              </li>
              
              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">Azure Projects</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header style="white-space:pre-line">
          </header>

          <header class="post-header">
            <h1 class="post-title">Logic App onboarding</h1>
            <p class="post-description"></p>
          </header>
        <header style="white-space:pre-line">
        Onboarding a user (creating an AzureAD account and assigning them to a group) using a Logic App and automating the setup using information from a Sharepoint list 

        <b>Resources used:</b>
        • Sharepoint environment (through the <a href="https://developer.microsoft.com/en-us/microsoft-365/dev-program">Microsoft Developer Program</a>)
        • Azure Logic app
        </header>

        <header style="white-space:pre-line">
          Initial setup included creating a blank Logic app and creating a Sharepoint list accessible using a user account to integrate with connectors for Sharepoint and AzureAD (EntraID)
        </header>

        <header style="white-space:pre-line">
          To begin a Sharepoint list was created with the headers <b>Name</b>, <b>Surname</b>, <b>Job Title</b> and <b>Department</b>, these were just placeholders in the begining but additional fields can be added in future as needed.
          <img src="InitSharepointList.PNG" style='border:1px solid #ffffff' alt="Sharepoint list">

          In the logic app 2 initial connectors were used, Sharepoint's "When an item is created" and Microsoft EntraID's "Create User"
          <img src="initialconnectors.PNG" style='border:1px solid #ffffff' alt="Initial connectors" >

          The required fields were added to both connectors:

          <img src="initialSharepointConnector.png" style='border:1px solid #ffffff' alt="Initial Sharepoint Connector">
          <img src="initialEntraIDConnector.png" style='border:1px solid #ffffff' alt="Initial EntraID connector">

          I ran an initial test of the app and this failed - looking at the error output it was relating to the User Principal name
          <img src="UPNerror.png" style='border:1px solid #ffffff' alt="Forest">

          This is a result of the connector being explicit in terms of only forwarding the exact information to EntraID - when you create an account manually through EntraID it will auto-fill the rest of the domain (e.g email@onmicrosoft.com)
          
          Instead, in this case the connector would forward the first & last name only, not adding the rest of the domain address - to resolve this I would have to explicitally add the rest of the domain
          <img src="UPNerrorfixed.png" style='border:1px solid #ffffff' alt="Forest">

          Running the logic app again I encounter a seperate error - this one relates to the 'Password' field in the connector:
          <img src="passworderror.png" style='border:1px solid #ffffff' alt="Forest">

          Since this relates to the complexity of the password I would have to add a bit more to the automatically generated password
          
          Looking at the EntraID user creation I can see the password requirements
          <img src="passwordrequirements.png" style='border:1px solid #ffffff' alt="Forest">

          To resolve this I added lower case and upper case characters to the connector:
          <img src="passworderrorfixed.png" style='border:1px solid #ffffff' alt="Forest">
          
          This would generate a password along the lines of <i>RandomPassword</i> and 8 digits
          
          Running the test a third time successfully creates the user account:
          <img src="successfulTestRun.png" style='border:1px solid #ffffff' alt="Forest">
          <img src="successfulTestRunOutput.png" style='border:1px solid #ffffff' alt="Forest">

          Alone this would work however I also added a few more things to make the onboarding process easier/more intuative
          First I created 2 Groups to represent the <i>Department</i> specified in the Sharepoint list

          <img src="Finance&ITgroup.png" style='border:1px solid #ffffff' alt="Forest">

          I then also converted their 'Membership type' to <i>Dynamically Assigned</i> to allow me to automatically add everyone with a specific department on their EntraID account to the correct group
          <img src="Finance&ITgroupDynamicMembership.png" style='border:1px solid #ffffff' alt="Forest">

          Secondly I also added a confirmation that the user account has been set up - currently as there is no confirmation there is no way to know the account was created other than having access to EntraID
          I chose to add a confirmation on the Sharepoint list to make it easy for the end user to see if the account was created

          This was done by adding an 'Update Item' connector after the Entra ID one that will mark update the 'User created' field on the Sharepoint list to 'Yes'
          <img src="UserCreatedSharepointConfirmation.png" style='border:1px solid #ffffff' alt="Forest">

          I then ran the logic app with 2 users, one for Finance and another for IT - both these ran sucessfully and had the expected outpiut
          <img src="DoubleTestRun.png" style='border:1px solid #ffffff' alt="Forest">
          <img src="AzureADBothUsers.png" style='border:1px solid #ffffff' alt="Forest">
          
          
          This updated the Sharepoint list as expected:
          <img src="DoubleTestRunSharepoint.png" style='border:1px solid #ffffff' alt="Forest">

          And this also automatically assinged them to the correct group:
          <img src="UsersInGroup.PNG" style='border:1px solid #ffffff' alt="Forest">

          Finally I also added an alert to the logic app - this would notify me whenever the Logic app failed to run:
          <img src="LogicAppAlert.png" style='border:1px solid #ffffff' alt="Forest">

          I verified this worked by inputting an invalid name in the Sharepoint list:
          <img src="LogicAppAlertSuccessful.png" style='border:1px solid #ffffff' alt="Forest">

          This logic app works automatically upon a user being created in the Sharepoint list, and has error alerts however this could be improved by:
          
          • <b>Excluding certain characters from the Sharepoint list</b> - specifically exluding symbols from the fields which would lead to errors
          • <b>Add a confirmation field to the Sharepoint list</b> - required that any row has a 'Confirmation' before the logic app creates the user - this would reduce/eliminate any user errors
          • <b>Assign additional permissions attached to the Groups</b> - such as access to enterprise apps or admin permissions to certain services
          • <b>Send out an onboarding email</b> - In my environment I don't have mailboxes but you could integrate the <i>Exchange</i> connectors and send out an email with the users email, password, added permissions etc to streamline onboarding
        </header> 


    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
  </body>
</html>

